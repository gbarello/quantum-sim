<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Interactive quantum mechanics simulation - observe wavefunction evolution and perform measurements on a quantum particle">
  <title>Quantum Particle Playground</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Quantum Particle Playground</h1>
    <p class="subtitle">Observe wavefunction evolution and perform measurements</p>
  </header>

  <main>
    <div class="simulation-wrapper">
      <!-- Left Panel: Initial Conditions -->
      <div class="left-panel controls-panel">
        <h2 class="panel-title">Initial Conditions</h2>

        <div class="selector-pair">
          <div class="selector-item">
            <label class="control-label">Position</label>
            <canvas id="position-selector" class="selector-canvas" width="100" height="100"
                    aria-label="Select starting position"></canvas>
            <div class="selector-info">
              <span id="position-display" class="selector-value">x: 0.00, y: 0.00</span>
            </div>
          </div>

          <div class="selector-item">
            <label class="control-label">Momentum</label>
            <canvas id="momentum-selector" class="selector-canvas" width="100" height="100"
                    aria-label="Select starting momentum"></canvas>
            <div class="selector-info">
              <span id="momentum-display" class="selector-value">px: 0.00, py: 0.00</span>
            </div>
          </div>
        </div>

        <div class="control-group">
          <div class="slider-control">
            <label for="packet-size-slider">
              Packet Size: <span id="packet-size-value" class="value-display">2.6</span>
            </label>
            <input
              type="range"
              id="packet-size-slider"
              min="20"
              max="400"
              value="256"
              step="1"
              aria-label="Adjust packet size"
            >
            <div class="slider-labels">
              <span>0.2</span>
              <span>4.0</span>
            </div>
          </div>
        </div>

        <div class="control-group">
          <button id="reset" class="btn btn-secondary btn-full-width" aria-label="Reset simulation">
            <span class="btn-icon" aria-hidden="true">↻</span>
            <span class="btn-text">Reset</span>
          </button>
        </div>
      </div>

      <!-- Center: Canvas -->
      <div class="simulation-container">
        <canvas id="quantum-canvas" aria-label="Quantum simulation canvas"></canvas>
        <div class="info-overlay" id="info-overlay" aria-live="polite">
          <!-- Dynamic measurement feedback will be displayed here -->
        </div>
        <div class="hover-info" id="hover-info" aria-hidden="true">
          <!-- Probability at cursor position -->
        </div>
      </div>

      <!-- Right Panel: Simulation Controls -->
      <div class="right-panel controls-panel">
        <h2 class="panel-title">Simulation Controls</h2>

        <!-- 1. Pause Button -->
        <div class="control-group">
          <button id="play-pause" class="btn btn-primary btn-full-width" aria-label="Play or pause simulation">
            <span class="btn-icon" aria-hidden="true">▶</span>
            <span class="btn-text">Play</span>
          </button>
        </div>

        <!-- 2. Speed -->
        <div class="control-group">
          <div class="slider-control">
            <label for="speed-slider">
              Speed: <span id="speed-value" class="value-display">0.10x</span>
            </label>
            <input
              type="range"
              id="speed-slider"
              min="-10"
              max="10"
              value="0"
              step="1"
              aria-label="Adjust simulation speed"
              aria-valuemin="-10"
              aria-valuemax="10"
              aria-valuenow="0"
            >
            <div class="slider-labels">
              <span>0.01x</span>
              <span>1.0x</span>
            </div>
          </div>
        </div>

        <!-- 3. Measurement Size -->
        <div class="control-group">
          <div class="slider-control">
            <label for="measurement-radius-slider">
              Measurement Size: <span id="measurement-radius-value" class="value-display">10.0</span>
            </label>
            <input
              type="range"
              id="measurement-radius-slider"
              min="0"
              max="200"
              value="100"
              step="1"
              aria-label="Adjust measurement radius"
              aria-valuemin="0"
              aria-valuemax="200"
              aria-valuenow="100"
            >
            <div class="slider-labels">
              <span>1</span>
              <span>100</span>
            </div>
          </div>
        </div>

        <!-- 4. Potential Type -->
        <div class="control-group">
          <div class="toggle-control potential-control">
            <label>Potential Type:</label>
            <div class="radio-group">
              <label>
                <span>None</span>
                <input type="radio" name="potential-type" value="none" aria-label="No potential">
              </label>
              <label>
                <span>Single</span>
                <input type="radio" name="potential-type" value="single" checked aria-label="Single well potential">
              </label>
              <label>
                <span>Double</span>
                <input type="radio" name="potential-type" value="double" aria-label="Double well potential">
              </label>
              <label>
                <span>Sin</span>
                <input type="radio" name="potential-type" value="sinusoid" aria-label="Sinusoidal potential">
              </label>
            </div>
          </div>
        </div>

        <!-- 5. Potential Strength -->
        <div class="control-group">
          <div class="slider-control">
            <label for="potential-strength-slider">
              Potential Strength: <span id="potential-strength-value" class="value-display">1.0</span>
            </label>
            <input
              type="range"
              id="potential-strength-slider"
              min="-10"
              max="10"
              value="0"
              step="1"
              aria-label="Adjust potential strength"
              aria-valuemin="-10"
              aria-valuemax="10"
              aria-valuenow="0"
            >
            <div class="slider-labels">
              <span>0.1</span>
              <span>10</span>
            </div>
          </div>
        </div>

        <!-- 6. Visualization -->
        <div class="control-group">
          <div class="toggle-control visualization-control">
            <label for="viz-mode">Visualization:</label>
            <select id="viz-mode" aria-label="Select visualization mode">
              <option value="complex">Complex (Phase + Amplitude)</option>
              <option value="probability" selected>Probability Density Only</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="info-panel">
      <section class="info-section">
        <h2>Instructions</h2>
        <ul class="instruction-list">
          <li><strong>Click</strong> on the canvas to perform a measurement</li>
          <li><strong>Hover</strong> to see probability at that location</li>
          <li><strong>Watch</strong> the wavefunction evolve and spread over time</li>
          <li>Measurements collapse the wavefunction based on quantum probability</li>
        </ul>
      </section>

      <section class="info-section phase-wheel-section">
        <h2>Phase Wheel Reference</h2>
        <div class="phase-wheel">
          <svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <!-- Phase wheel visualization -->
            <defs>
              <linearGradient id="phase-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:hsl(0,100%,50%);stop-opacity:1" />
                <stop offset="25%" style="stop-color:hsl(90,100%,50%);stop-opacity:1" />
                <stop offset="50%" style="stop-color:hsl(180,100%,50%);stop-opacity:1" />
                <stop offset="75%" style="stop-color:hsl(270,100%,50%);stop-opacity:1" />
                <stop offset="100%" style="stop-color:hsl(360,100%,50%);stop-opacity:1" />
              </linearGradient>
            </defs>
            <circle cx="100" cy="100" r="80" fill="none" stroke="url(#phase-gradient)" stroke-width="20"/>
            <text x="180" y="105" font-size="14" fill="var(--text-color)">0�</text>
            <text x="95" y="30" font-size="14" fill="var(--text-color)">90�</text>
            <text x="10" y="105" font-size="14" fill="var(--text-color)">180�</text>
            <text x="90" y="185" font-size="14" fill="var(--text-color)">270�</text>
          </svg>
        </div>
        <p class="phase-description">
          Color <strong>hue</strong> indicates phase angle,
          <strong>brightness</strong> indicates amplitude
        </p>
      </section>

      <section class="info-section stats-section">
        <h2>Statistics</h2>
        <div class="stats-grid">
          <div class="stat-item">
            <span class="stat-label">Total Probability:</span>
            <span class="stat-value" id="total-probability">100.0%</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Time Elapsed:</span>
            <span class="stat-value" id="time-elapsed">0.00s</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Grid Size:</span>
            <span class="stat-value" id="grid-size">128�128</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">Measurements:</span>
            <span class="stat-value" id="measurement-count">0</span>
          </div>
        </div>
      </section>
    </div>
  </main>

  <footer>
    <details class="about-section">
      <summary>About this simulation</summary>
      <div class="about-content">
        <h3>Physics Background</h3>
        <p>
          This simulation solves the time-dependent Schr�dinger equation for a free quantum particle
          in 2D space. The wavefunction �(x,y,t) describes the quantum state, with |�|� giving
          the probability density of finding the particle at each location.
        </p>

        <h3>Color Encoding</h3>
        <p>
          The complex wavefunction is visualized using color: the <strong>hue</strong> (color)
          represents the quantum phase angle � = arg(�), while the <strong>saturation/brightness</strong>
          represents the amplitude |�|. This allows you to see both the "where" (probability) and
          the "how" (quantum phase) of the particle's state.
        </p>

        <h3>Measurements</h3>
        <p>
          When you click to perform a measurement, the simulation uses the Born rule to
          probabilistically determine the outcome based on |�(x,y)|�. If the particle is found
          at that location, the wavefunction collapses to that position. If not found,
          that location is zeroed out and the wavefunction is renormalized.
        </p>

        <h3>Technical Details</h3>
        <p>
          The simulation uses the split-operator method with Fast Fourier Transforms (FFT)
          to accurately evolve the wavefunction while preserving unitarity. Periodic boundary
          conditions are applied (the space wraps around like a torus).
        </p>

        <h3>Credits</h3>
        <p>
          Built with vanilla JavaScript and HTML5 Canvas. Open source and educational.
        </p>
      </div>
    </details>

    <p class="copyright">
      &copy; 2025 Quantum Particle Playground |
      <a href="https://github.com/yourusername/quantum-play" target="_blank" rel="noopener noreferrer">View Source</a>
    </p>
  </footer>

  <script type="module" src="js/main.js"></script>
</body>
</html>
